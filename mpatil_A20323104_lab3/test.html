//Drawing the animated square
var requestAnimationFrame = 
 window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        function(callback) {
          return setTimeout(callback, 16);
        };
        
var render = function() {
ctx.clearRect(420, 80, 140, 140);
ctx.beginPath();
 ctx.fillRect(420, 80, 140, 140);
 ctx.fillStyle = "red";
 ctx.fill();
 ctx.lineWidth = 2;
ctx.strokeStyle = 'white';
ctx.stroke();
requestAnimationFrame(render);
};

render(); 
 
 var animate = function(prop, val, duration){
   var start = new Date().getTime();
var end = start + duration;
var current = square[prop];
var distance = val - current;

var step = function() {
    // Get our current progres
    var timestamp = new Date().getTime();
    var progress = Math.min((duration - (end - timestamp)) / duration, 1);

    // Update the square's property
    square[prop] = current + (distance * progress);

    // If the animation hasn't finished, repeat the step.
    if (progress < 1) requestAnimationFrame(step);
  };

  // Start the animation
  return step();  
     
 };
 animate('x', 0, 1000);
 